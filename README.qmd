---
title: tidychat
format: md
---

<!-- badges: start -->

[![R-CMD-check](https://github.com/edgararuiz/tidychat/actions/workflows/R-CMD-check.yaml/badge.svg)](https://github.com/edgararuiz/tidychat/actions/workflows/R-CMD-check.yaml) [![Codecov test coverage](https://codecov.io/gh/edgararuiz/tidychat/branch/main/graph/badge.svg)](https://app.codecov.io/gh/edgararuiz/tidychat?branch=main) [![CRAN status](https://www.r-pkg.org/badges/version/tidychat)](https://CRAN.R-project.org/package=tidychat) [![](man/figures/lifecycle-experimental.svg)](https://lifecycle.r-lib.org/articles/stages.html#experimental)

<!-- badges: end -->

```{r}
#| echo: false
#| eval: false

library(rstudioapi)
ac <- getActiveDocumentContext()
content <- ac$contents

is_title <- substr(content, 1, 1) == "#" & substr(content, 2, 2) != "|"

title <- content[is_title]

toc_start <- "<!-- toc: start -->"
toc_end <- "<!-- toc: end -->" 

toc <- NULL
for(i in seq_along(title)) {
  current_title <- title[i]
  if(substr(current_title, 1, 4) == "### ") {
    new_title <- substr(current_title, 5, nchar(current_title))
    spacing <- "    - "
  }
  if(substr(current_title, 1, 3) == "## ") {
    new_title <- substr(current_title, 4, nchar(current_title))
    spacing <- "- "
  }
  new_link <- tolower(new_title)
  new_link <- gsub(" ", "-", new_link)
  ret <- paste0(spacing, "[", new_title, "](#", new_link, ")")
  toc <- c(toc, ret)
}

toc <- paste0(toc_start, "\n", 
              paste0(toc, collapse = "\n"), 
              "\n\n", toc_end)

pos_start <- as.document_position(c(which(content == toc_start), 1))
pos_end <- as.document_position(c(which(content == toc_end), nchar(toc_end) + 1))

pos_range <- document_range(pos_start, pos_end)

modifyRange(pos_range, toc)

```

## Install {#install}

Since this is a very early version of the package, you can either clone the repo, or install the package from GH:

```{r}
#| eval: false
remotes::install_github("edgararuiz/tidychat")
```

## Getting Started {#getting-started}

### Secret key

OpenAI requires a **secret key** to authenticate your user. It is required for any application non-OpenAI application, such as `tidychat`, to have one in order to function. A key is a long alphanumeric sequence. The sequence is created in the OpenAI portal. To obtain your **secret key**, follow this link: [OpenAI API Keys](https://platform.openai.com/account/api-keys)

By default, `tidychat` will look for the **secret key** inside the a Environment Variable called `OPENAI_API_KEY`. Other packages that integrate with OpenAI use the same variable name.

Use `Sys.setenv()` to set the variable. The downside of using this method is that the variable will only be available during the current R session:

``` r
Sys.setenv("OPENAI_API_KEY" = "####################")
```

A preferred method is to save the secret key to the `.Renviron` file. This way, there is no need to load the environment variable every time you start a new R session. The `.Renviron` file is available in your home directory. Here is an example of the entry:

    OPENAI_API_KEY=####################

### Test connection

``` r
tidychat_test()
✔ Connection with OpenAI cofirmed
✔ Access to models confirmed
```

### Usage

![](man/figures/readme/chat1.png)

### Use with `tidychat_app()`

```{r}
#| eval: false
tidychat::tidychat_app()
```

    Show in New Window
    • Provider: Open AI
    • Model: GPT 3.5 Turbo
    Loading required package: shiny

    Listening on http://127.0.0.1:5253

## Appendix {#appendix}

### How to setup the keyboard shortcut {#how-to-setup-the-keyboard-shortcut}

-   Select *Tools* in the top menu, and then select *Modify Keyboard Shortcuts* ![](man/figures/readme/keyboard-shortcuts.png){width="800"}

-   Search for the `tidychat` adding by writing "open chat", in the search box\
    ![](man/figures/readme/addin-find.png){width="500"}

-   To select a key combination for your shortcut, click on the Shortcut box and then type *press* the key combination in your keyboard. In my case, I chose *Ctrl+Shift+C* ![](man/figures/readme/addin-assign.png){width="600"}
